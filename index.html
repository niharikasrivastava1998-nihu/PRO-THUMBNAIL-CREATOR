<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creator Core v4.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Permanent+Marker&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #0c0c0e; --ui: #1a1a1c; --accent: #6366f1; --text: #f4f4f5; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; height: 100vh; }
        .sidebar { width: 420px; background: var(--ui); padding: 20px; overflow-y: auto; border-right: 1px solid #2d2d30; }
        .canvas-area { flex: 1; display: flex; align-items: center; justify-content: center; padding: 20px; position: relative; }
        .tool-box { background: #27272a; padding: 15px; border-radius: 12px; margin-bottom: 15px; }
        h3 { font-size: 11px; text-transform: uppercase; color: var(--accent); margin: 0 0 10px 0; letter-spacing: 1px; }
        select, input, button { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #3f3f46; background: #0c0c0e; color: white; margin-bottom: 8px; }
        .emoji-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; }
        .btn-bake { background: var(--accent); border: none; font-weight: bold; cursor: pointer; padding: 16px; margin-top: 10px; font-size: 15px; }
        video { width: 100%; border-radius: 10px; margin-bottom: 10px; }
        canvas { max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }
    </style>
</head>
<body>

<div class="sidebar">
    <h3>1. Video & Templates</h3>
    <input type="file" id="vidIn" accept="video/*">
    <video id="v" controls></video>
    
    <select id="template" onchange="applyTemplate()">
        <option value="none">Choose a Style...</option>
        <option value="funky">üî• Template: Funky (MrBeast Style)</option>
        <option value="paper">‚úÇÔ∏è Template: Paper Cutout</option>
        <option value="doodle">‚úèÔ∏è Template: Doodle Highlight</option>
        <option value="emoji">üòÇ Template: Emoji Challenge</option>
    </select>

    <div class="tool-box">
        <h3>2. Text & Font</h3>
        <input type="text" id="tMain" placeholder="MAIN TEXT">
        <select id="fFam">
            <option value="Impact">Impact</option>
            <option value="'Bangers'">Bangers</option>
            <option value="'Permanent Marker'">Doodle Marker</option>
        </select>
        <input type="color" id="tCol" value="#ffffff">
    </div>

    <div class="tool-box">
        <h3>3. Emojis (Click to Add)</h3>
        <div class="emoji-grid">
            <button onclick="addEmoji('üòÇ')">üòÇ</button>
            <button onclick="addEmoji('üî•')">üî•</button>
            <button onclick="addEmoji('üò±')">üò±</button>
            <button onclick="addEmoji('üíØ')">üíØ</button>
        </div>
        <button onclick="clearEmojis()" style="font-size:10px; background:#444;">Clear Emojis</button>
    </div>

    <button class="btn-bake" onclick="bake()">BAKE & PREVIEW</button>
    <button class="btn-bake" style="background:#10b981" onclick="dl()">DOWNLOAD THUMBNAIL</button>
</div>

<div class="canvas-area">
    <canvas id="c"></canvas>
</div>

<script>
    const vid = document.getElementById('v'), can = document.getElementById('c'), ctx = can.getContext('2d');
    let emojisOnCanvas = [];

    document.getElementById('vidIn').onchange = (e) => vid.src = URL.createObjectURL(e.target.files[0]);

    function addEmoji(e) {
        emojisOnCanvas.push({ char: e, x: Math.random() * 0.8, y: Math.random() * 0.8 });
        bake(); // Live update
    }

    function clearEmojis() { emojisOnCanvas = []; bake(); }

    function applyTemplate() {
        const t = document.getElementById('template').value;
        if(t === 'funky') {
            document.getElementById('fFam').value = "'Bangers'";
            document.getElementById('tCol').value = "#ffff00";
        } else if (t === 'paper') {
            document.getElementById('fFam').value = "Impact";
        } else if (t === 'doodle') {
            document.getElementById('fFam').value = "'Permanent Marker'";
        }
        bake();
    }

    function bake() {
        const W = 1280, H = 720;
        can.width = W; can.height = H;
        const template = document.getElementById('template').value;

        // 1. Base Image Logic
        const vR = vid.videoWidth / vid.videoHeight, tR = W / H;
        let dW = W, dH = H;
        if (vR > tR) { dW = H * vR; } else { dH = W / vR; }
        const oX = (W - dW)/2, oY = (H - dH)/2;

        ctx.clearRect(0, 0, W, H);
        
        // Filter Logic
        if(template === 'emoji') ctx.filter = "grayscale(1) contrast(1.2)";
        else if(template === 'funky') ctx.filter = "contrast(1.3) saturate(1.5)";
        else ctx.filter = "none";

        ctx.drawImage(vid, oX, oY, dW, dH);
        ctx.filter = "none";

        // 2. Specialized Effects
        if(template === 'paper') {
            ctx.strokeStyle = "white"; ctx.lineWidth = 20;
            ctx.shadowColor = "black"; ctx.shadowBlur = 15;
            ctx.strokeRect(30, 30, W-60, H-60); //
        } else if(template === 'funky') {
            const g = ctx.createLinearGradient(0,0,W,H);
            g.addColorStop(0, "rgba(255,0,80,0.2)"); g.addColorStop(1, "rgba(0,242,234,0.2)");
            ctx.fillStyle = g; ctx.fillRect(0,0,W,H); //
        } else if(template === 'doodle') {
            ctx.strokeStyle = "#FFEB3B"; ctx.lineWidth = 10; ctx.setLineDash([15, 10]);
            ctx.strokeRect(50, 50, W-100, H-100); //
            ctx.setLineDash([]);
        }

        // 3. Emoji Layers
        emojisOnCanvas.forEach(item => {
            ctx.font = "120px Arial";
            ctx.fillText(item.char, item.x * W, item.y * H); //
        });

        // 4. Text Rendering
        const txt = document.getElementById('tMain').value;
        if(txt) {
            ctx.font = `bold 120px ${document.getElementById('fFam').value}`;
            ctx.fillStyle = document.getElementById('tCol').value;
            ctx.textAlign = "center";
            ctx.shadowColor = "black"; ctx.shadowBlur = 20;
            ctx.fillText(txt.toUpperCase(), W/2, H*0.85);
        }
    }

    function dl() {
        const l = document.createElement('a'); l.download = 'thumbnail.png'; l.href = can.toDataURL(); l.click();
    }
</script>
</body>
</html>
