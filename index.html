<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Platform Thumbnail Pro</title>
    <style>
        :root { --bg: #0b0e14; --card: #161b22; --accent: #58a6ff; --text: #c9d1d9; --btn: #238636; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 20px; }
        .wrapper { max-width: 1200px; margin: 0 auto; display: grid; grid-template-columns: 1fr 350px; gap: 25px; }
        .main-view { background: var(--card); padding: 20px; border-radius: 12px; border: 1px solid #30363d; }
        .sidebar { background: var(--card); padding: 20px; border-radius: 12px; border: 1px solid #30363d; height: fit-content; }
        video { width: 100%; border-radius: 8px; background: #000; box-shadow: 0 4px 12px rgba(0,0,0,0.5); }
        canvas { width: 100%; border-radius: 8px; margin-top: 20px; display: none; border: 1px solid var(--accent); }
        h3 { margin: 15px 0 8px 0; color: var(--accent); font-size: 13px; text-transform: uppercase; letter-spacing: 0.5px; }
        input, select, button { width: 100%; padding: 12px; border-radius: 6px; border: 1px solid #30363d; background: #0d1117; color: white; margin-bottom: 12px; box-sizing: border-box; }
        .btn-gen { background: var(--btn); border: none; font-weight: bold; cursor: pointer; padding: 15px; font-size: 16px; margin-top: 10px; }
        .btn-gen:hover { background: #2ea043; }
        .badge { background: #30363d; padding: 4px 8px; border-radius: 4px; font-size: 11px; margin-bottom: 10px; display: inline-block; }
    </style>
</head>
<body>

<div class="wrapper">
    <div class="main-view">
        <span class="badge">STEP 1: UPLOAD & SEEK</span>
        <input type="file" id="videoUpload" accept="video/*">
        <video id="videoPlayer" controls></video>
        <canvas id="canvas"></canvas>
    </div>

    <div class="sidebar">
        <span class="badge">STEP 2: CUSTOMIZE</span>
        
        <h3>Platform Preset</h3>
        <select id="platform">
            <option value="1280/720">YouTube (16:9)</option>
            <option value="1080/1920">TikTok / IG Reel (9:16)</option>
            <option value="1200/627">LinkedIn Post (1.91:1)</option>
            <option value="1200/630">Facebook Post (1.9:1)</option>
            <option value="1080/1350">Instagram Portrait (4:5)</option>
            <option value="1080/1080">Square (1:1)</option>
        </select>

        <h3>Headline Text</h3>
        <input type="text" id="mainText" placeholder="e.g. NEW CAMPAIGN">
        
        <h3>Effect Theme</h3>
        <select id="theme">
            <option value="vivid">Vivid (High Contrast)</option>
            <option value="spotlight">Human Spotlight (Blur BG)</option>
            <option value="glitch">Digital Glitch (RGB Shift)</option>
            <option value="paper">Paper Cutout (White Frame)</option>
            <option value="doodle">Doodle (Hand-drawn Highlight)</option>
        </select>

        <h3>Text Color</h3>
        <input type="color" id="textColor" value="#ffffff">

        <button class="btn-gen" onclick="render()">BAKE THUMBNAIL</button>
        <button id="dlBtn" style="display:none; background: #8b5cf6;" class="btn-gen" onclick="download()">DOWNLOAD PNG</button>
    </div>
</div>

<script>
    const video = document.getElementById('videoPlayer');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    document.getElementById('videoUpload').onchange = (e) => {
        video.src = URL.createObjectURL(e.target.files[0]);
    };

    function render() {
        // 1. Get Platform Dimensions
        const size = document.getElementById('platform').value.split('/');
        const W = parseInt(size[0]);
        const H = parseInt(size[1]);
        canvas.width = W;
        canvas.height = H;

        const theme = document.getElementById('theme').value;
        const targetRatio = W / H;
        const videoRatio = video.videoWidth / video.videoHeight;

        // 2. Smart Crop Logic
        let drawW, drawH;
        if (videoRatio > targetRatio) {
            drawH = H;
            drawW = H * videoRatio;
        } else {
            drawW = W;
            drawH = W / videoRatio;
        }
        const x = (W - drawW) / 2;
        const y = (H - drawH) / 2;

        // 3. Render Base Layers based on Theme
        ctx.clearRect(0, 0, W, H);
        
        if (theme === 'spotlight') {
            ctx.filter = "blur(15px) brightness(0.4)";
            ctx.drawImage(video, x, y, drawW, drawH);
            ctx.filter = "none";
            ctx.save();
            ctx.beginPath();
            ctx.arc(W/2, H/3, Math.min(W,H)*0.4, 0, Math.PI*2);
            ctx.clip();
            ctx.drawImage(video, x, y, drawW, drawH);
            ctx.restore();
        } else if (theme === 'glitch') {
            ctx.globalAlpha = 0.7;
            ctx.drawImage(video, x - 5, y, drawW, drawH);
            ctx.fillStyle = "rgba(255,0,0,0.2)";
            ctx.fillRect(0,0,W,H);
            ctx.drawImage(video, x + 5, y, drawW, drawH);
            ctx.globalAlpha = 1.0;
        } else {
            ctx.filter = "contrast(1.15) saturate(1.2)";
            ctx.drawImage(video, x, y, drawW, drawH);
            ctx.filter = "none";
        }

        // 4. Overlays
        if (theme === 'doodle') {
            ctx.strokeStyle = "#ffeb3b";
            ctx.lineWidth = 6;
            ctx.setLineDash([10, 10]);
            ctx.strokeRect(30, 30, W-60, H-60);
            ctx.setLineDash([]);
        } else if (theme === 'paper') {
            ctx.strokeStyle = "white";
            ctx.lineWidth = 40;
            ctx.strokeRect(0,0,W,H);
        }

        // 5. Professional Typography
        const text = document.getElementById('mainText').value;
        if (text) {
            ctx.shadowColor = "rgba(0,0,0,0.9)";
            ctx.shadowBlur = 20;
            ctx.fillStyle = document.getElementById('textColor').value;
            const fontSize = Math.round(H * 0.1);
            ctx.font = `italic bold ${fontSize}px sans-serif`;
            ctx.textAlign = "center";
            ctx.fillText(text.toUpperCase(), W/2, H * 0.85);
        }

        canvas.style.display = 'block';
        document.getElementById('dlBtn').style.display = 'block';
        canvas.scrollIntoView({ behavior: 'smooth' });
    }

    function download() {
        const link = document.createElement('a');
        link.download = `thumbnail-${Date.now()}.png`;
        link.href = canvas.toDataURL('image/png', 1.0);
        link.click();
    }
</script>
</body>
</html>
